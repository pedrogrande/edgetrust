# @format

# ============================================================================
# Smart Contract System Ontology
# ============================================================================

feature: contracts
extends: futuresedge-core
version: 1.0.0
description: Smart contract-driven action and reward system

# ============================================================================
# Thing Types - Contract Entities
# ============================================================================

thingTypes:
  # Core contract entity
  - name: action_contract
    description: Smart contract defining an action, requirements, and rewards
    properties:
      # Contract identity
      contractType: string # mission, knowledge_contribution, governance, attendance, mentoring, connection
      title: string
      description: string
      category: string

      # Eligibility - who can accept this contract
      eligibility:
        object
        # minTrustScore: number
        # maxTrustScore: number (for beginner-only missions)
        # requiredRank: string[]
        # requiredBadges: string[]
        # requiredDivision: string
        # maxActiveContracts: number
        # fieldOfficeId: string (location-specific)

      # Requirements - what must be done
      requirements:
        object
        # action: string (description of work)
        # deliverables: string[]
        # constraints: object (time, resources, etc)

      # Proof requirements - what evidence is needed
      requiredProof:
        object
        # proofTypes: string[] (document, attestation, blockchain_tx, peer_review)
        # minimumReviews: number
        # reviewerCriteria: object
        # reviewThreshold: number (average rating needed)
        # autoVerify: boolean
        # verificationLogic: object (for automated verification)

      # Value generated by fulfilling contract
      valueGenerated:
        object
        # organizationalValue:
        #   knowledgeAsset: boolean
        #   communityGrowth: number
        #   networkEffect: number
        #   revenueImpact: number
        # individualValue:
        #   trustPoints: number
        #   impactScore: number
        #   leadershipScore: number
        #   gratitudePoints: number
        #   tokens: number
        #   skillBadges: string[]

      # Reward distribution - how value splits
      rewardDistribution:
        object
        # actor: number (percentage as decimal, e.g., 0.80)
        # reviewers: number
        # mentor: number
        # fieldOffice: number
        # platform: number

      # Validity period
      validityPeriod:
        object
        # startDate: number
        # endDate: number
        # maxFulfillments: number
        # currentFulfillments: number

      # Contract state
      status: string # draft, active, paused, fulfilled, expired, cancelled
      createdBy: string
      createdAt: number

      # Template reference
      templateId: string
      templateVersion: string

      # Dependencies
      prerequisiteContracts: string[]
      unlocksContracts: string[]

    example:
      type: action_contract
      name: "Complete Blockchain Basics Mission"
      properties:
        contractType: "mission"
        eligibility:
          minTrustScore: 0
          requiredRank: ["recruit", "novice", "member"]
          maxActiveContracts: 3
        requiredProof:
          proofTypes: ["submission_document", "peer_review"]
          minimumReviews: 2
          reviewThreshold: 3.5
        valueGenerated:
          individualValue:
            trustPoints: 50
            tokens: 100
            skillBadges: ["blockchain_basics"]
        rewardDistribution:
          actor: 0.80
          reviewers: 0.15
          platform: 0.05

  # Contract template - reusable pattern
  - name: contract_template
    description: Template for creating multiple similar contracts
    properties:
      templateType: string
      category: string
      baseProperties: object
      variableFields: string[]
      scalingFactors:
        object
        # difficulty: { easy: 0.5, medium: 1.0, hard: 2.0 }
        # urgency: { standard: 1.0, urgent: 1.5 }
      defaultRewards: object
      version: string

    example:
      type: contract_template
      name: "Standard Mission Template"
      properties:
        templateType: "mission"
        baseProperties:
          eligibility:
            maxActiveContracts: 3
        scalingFactors:
          difficulty: { easy: 0.5, medium: 1.0, hard: 2.0, expert: 3.0 }
        defaultRewards:
          trustPoints: 50
          tokens: 100

  # Contract fulfillment record
  - name: contract_fulfillment
    description: Record of contract acceptance and completion
    properties:
      contractId: string
      actorId: string

      # Acceptance
      acceptedAt: number
      estimatedCompletionDate: number

      # Submission
      submittedAt: number
      proofSubmitted:
        object[]
        # proofId: string
        # proofType: string
        # submittedAt: number

      # Verification
      verificationStatus: string # pending, under_review, approved, rejected, disputed
      verifiedBy: string
      verifiedAt: number
      verificationNotes: string

      # Reviews
      reviews:
        object[]
        # reviewerId: string
        # rating: number
        # feedback: string
        # reviewedAt: number
      avgRating: number

      # Rewards
      valueAwarded: object
      rewardsDistributed: boolean
      distributedAt: number

      # Dispute
      disputed: boolean
      disputeReason: string
      disputeResolution: string

    example:
      type: contract_fulfillment
      name: "Mission Completion: Blockchain Basics"
      properties:
        contractId: "contract_123"
        actorId: "member_456"
        acceptedAt: 1738800000000
        submittedAt: 1739900000000
        verificationStatus: "approved"
        avgRating: 4.5
        valueAwarded:
          trustPoints: 50
          tokens: 80
          skillBadges: ["blockchain_basics"]

  # Proof artifact
  - name: proof_artifact
    description: Evidence submitted to fulfill contract
    properties:
      fulfillmentId: string
      artifactType: string # document, image, video, code, attestation, blockchain_tx, peer_statement

      # Content
      content: string # URL, IPFS hash, or inline data
      contentHash: string # SHA-256 hash for integrity
      title: string
      description: string

      # Storage
      storageLocation: string # ipfs, s3, arweave, local
      storageUrl: string

      # Metadata
      metadata:
        object
        # fileSize: number
        # mimeType: string
        # duration: number (for video/audio)
        # wordCount: number (for documents)
        # topics: string[]

      # Attestations
      attestations:
        object[]
        # attesterId: string
        # attestationType: string (peer_review, expert_validation, automated_check)
        # result: string (pass, fail, needs_revision)
        # score: number
        # notes: string
        # timestamp: number
        # signature: string (cryptographic signature)

      # Blockchain anchor (optional)
      blockchainProof:
        object
        # network: string
        # txHash: string
        # blockNumber: number
        # timestamp: number
        # explorerUrl: string

      timestamp: number
      submittedBy: string

    example:
      type: proof_artifact
      name: "Mission Report: Blockchain Basics"
      properties:
        artifactType: "document"
        content: "ipfs://QmX1234..."
        contentHash: "sha256:abc123..."
        attestations:
          - attesterId: "reviewer_789"
            score: 4.5
            notes: "Excellent work"
            timestamp: 1739950000000

  # Composite contract (mission with sub-tasks)
  - name: composite_contract
    description: Complex contract composed of multiple sub-contracts
    properties:
      title: string
      description: string
      subContracts:
        object[]
        # contractId: string
        # order: number
        # prerequisite: string (previous contractId)
        # optional: boolean

      requiresSequential: boolean
      allowParallel: boolean

      totalReward: object
      completionBonus: object

      progressTracking:
        object
        # completed: number
        # total: number
        # percentage: number

      status: string

  # Contract dispute
  - name: contract_dispute
    description: Formal dispute regarding contract fulfillment
    properties:
      fulfillmentId: string
      contractId: string
      disputerId: string

      disputeType: string # unfair_rejection, incorrect_verification, reward_calculation_error
      reason: string
      evidence: string[]

      requestedAction: string # re_review, escalate_to_council, modify_contract

      # Resolution
      status: string # open, under_review, resolved, closed
      assignedTo: string # council member or mediator
      resolution: string
      resolvedAt: number
      resolvedBy: string

# ============================================================================
# Connection Types - Contract Relationships
# ============================================================================

connectionTypes:
  # Contract lifecycle
  - name: created_contract
    description: Member created a contract
    fromType: member
    toType: action_contract
    metadata:
      createdAt: number
      role: string # creator, template_instantiator

  - name: accepted_contract
    description: Member accepted/committed to contract
    fromType: member
    toType: action_contract
    metadata:
      acceptedAt: number
      estimatedCompletion: number
      priority: string

  - name: fulfills
    description: Fulfillment record fulfills contract
    fromType: contract_fulfillment
    toType: action_contract
    metadata:
      acceptedAt: number
      submittedAt: number
      completionTime: number # days

  - name: provides_proof
    description: Fulfillment includes proof artifact
    fromType: contract_fulfillment
    toType: proof_artifact
    metadata:
      proofOrder: number
      required: boolean

  # Review and verification
  - name: reviewed_by
    description: Fulfillment was reviewed by member
    fromType: contract_fulfillment
    toType: member
    metadata:
      rating: number
      feedback: string
      reviewedAt: number
      reviewDuration: number # minutes spent reviewing

  - name: verified_by
    description: Final verification by authorized person
    fromType: contract_fulfillment
    toType: member
    metadata:
      verifiedAt: number
      verificationNotes: string
      approved: boolean

  - name: attested_by
    description: Proof was attested by reviewer
    fromType: proof_artifact
    toType: member
    metadata:
      attestationType: string
      score: number
      timestamp: number
      signature: string

  # Rewards
  - name: awarded_to
    description: Rewards distributed to member
    fromType: contract_fulfillment
    toType: member
    metadata:
      trustPoints: number
      impactScore: number
      leadershipScore: number
      gratitudePoints: number
      tokens: number
      skillBadges: string[]
      distributedAt: number
      role: string # actor, reviewer, mentor

  # Disputes
  - name: disputed_by
    description: Fulfillment was disputed by member
    fromType: contract_fulfillment
    toType: member
    metadata:
      disputedAt: number
      reason: string

  - name: resolves_dispute
    description: Dispute resolution for fulfillment
    fromType: contract_dispute
    toType: contract_fulfillment
    metadata:
      resolvedAt: number
      outcome: string

  # Templates
  - name: instantiated_from
    description: Contract created from template
    fromType: action_contract
    toType: contract_template
    metadata:
      instantiatedAt: number
      templateVersion: string
      customizations: object

  # Composite relationships
  - name: part_of
    description: Sub-contract is part of composite contract
    fromType: action_contract
    toType: composite_contract
    metadata:
      order: number
      prerequisite: string
      optional: boolean

  - name: prerequisite_for
    description: Contract must be completed before another
    fromType: action_contract
    toType: action_contract
    metadata:
      unlockConditions: object

# ============================================================================
# Event Types - Contract Actions
# ============================================================================

eventTypes:
  # Contract lifecycle
  - name: contract_created
    description: New contract was created
    thingType: action_contract

  - name: contract_published
    description: Contract made available for acceptance
    thingType: action_contract

  - name: contract_updated
    description: Contract terms were modified
    thingType: action_contract

  - name: contract_paused
    description: Contract temporarily unavailable
    thingType: action_contract

  - name: contract_cancelled
    description: Contract was cancelled
    thingType: action_contract

  - name: contract_expired
    description: Contract validity period ended
    thingType: action_contract

  # Acceptance and work
  - name: contract_accepted
    description: Member committed to fulfilling contract
    thingType: action_contract

  - name: contract_abandoned
    description: Member gave up on contract
    thingType: action_contract

  - name: work_progress_updated
    description: Member provided progress update
    thingType: contract_fulfillment

  # Submission and proof
  - name: proof_submitted
    description: Evidence submitted for contract
    thingType: contract_fulfillment

  - name: additional_proof_requested
    description: Reviewers need more evidence
    thingType: contract_fulfillment

  - name: proof_updated
    description: Additional evidence provided
    thingType: contract_fulfillment

  # Review and verification
  - name: review_requested
    description: Fulfillment ready for peer review
    thingType: contract_fulfillment

  - name: review_completed
    description: Peer review submitted
    thingType: contract_fulfillment

  - name: verification_completed
    description: Final verification done
    thingType: contract_fulfillment

  - name: contract_fulfilled
    description: Contract successfully completed
    thingType: action_contract

  - name: contract_rejected
    description: Fulfillment did not meet requirements
    thingType: contract_fulfillment

  # Rewards
  - name: reward_calculated
    description: Rewards computed for fulfillment
    thingType: contract_fulfillment

  - name: reward_distributed
    description: Value awarded to participant
    thingType: contract_fulfillment

  # Disputes
  - name: contract_disputed
    description: Fulfillment or verification disputed
    thingType: contract_fulfillment

  - name: dispute_escalated
    description: Dispute sent to council
    thingType: contract_dispute

  - name: dispute_resolved
    description: Dispute outcome determined
    thingType: contract_dispute

  # Analytics
  - name: contract_viewed
    description: Member viewed contract details
    thingType: action_contract

  - name: contract_favorited
    description: Member bookmarked contract
    thingType: action_contract
